if ($.browser.msie && $.browser.version < 7 && getParam("cont") != "1") { window.location = "browser_ie.htm" } $(window).load(function() { pageLoaded = true }); var navigationEnableTimerHandler; var navigationEnableTimer = 0; var navigationEnabled = false; var clipResultsStartDelay = 500; var clipResultsShowOffset = 100; function highlightTab(A) { $("#categories span").removeClass("selected"); $(A).addClass("selected") } function btnClipSearch_Click() { var B = $("#categories .selected"); var A = B.attr("id"); var E = $("#txtSearchTerms").val(); E = (E == "Begin your search") ? "" : E; togglePopup("local", "clip", true); togglePopup("raw", "nav", true); var D = new RedLasso.Domain.ClipSearchRequest(); D.setTerms(E); if (A == "MYCLIPS") { D.setUserId(RL_CurrentUser.Guid); var C = (E != "") ? "My Clips Results for <i>" + E + "</i>" : ""; searchClips(D, C) } else { if (A == "LOCAL") { var G = ""; $("#localPopup .map_selections .stationList").children().each(function() { G += $(this).attr("name") + " " }); D.addMetaData("stationid", G); var F = new Array(); $("#localPopup .map_selections .details span").each(function() { F.push($(this).text()) }); var C = ""; if (E != "" || F.length > 0) { C += "Search Results"; if (E != "") { C += " for <i>" + E + "</i>" } if (F.length > 0) { C += " in " + F.join(" | ") } } searchClips(D, C) } else { C = (E != "") ? "Search Results for <i>" + E + "</i>" : ""; D.setTerms(E); if (RedLasso.Util.CategoryValidator.test(A)) { D.setCategory(A) } searchClips(D, C) } } } function btnTab_Click() { if (this.id == "LOCAL") { highlightTab(this); toggleLocalPopup("clip") } else { if (this.id == "MYCLIPS") { if (true) { highlightTab(this); $("#txtSearchTerms").val("Begin your search"); btnClipSearch_Click() } else { displayUnauthenticatedMessage() } } else { highlightTab(this); btnClipSearch_Click() } } } function btnAllClipsSearch_Click() { $("#txtSearchTerms").val($("#txtAllClipsSearchTerms").val()); var A = $("#ddlCategories").val(); A = (A == "") ? "#ALL" : "#" + A; btnTab_Click.call($(A)); window.scroll(0, 565) } function btnLocalClipsSearch_Click() { highlightTab($("#LOCAL")); btnClipSearch_Click(); window.scroll(0, 565) } function btnRawSearch_Click() { var I = ""; var E = $("#txtRawSearchTerms").val(); if (E == "" || E == "Enter your search term(s)") { I += "Please enter a search term.\n" } if ($("#rawPopup .map_selections .stationList").children().length == 0) { I += "Please Select a market or station." } if (I != "") { alert(I); showMapPopup("raw", "nav"); return false } var G = new RedLasso.Domain.RawSearchRequest(); G.setTerms($("#txtRawSearchTerms").val()); $("#rawPopup .map_selections .stationList").children().each(function() { var K = $(this).attr("name").split(" "); for (var J = 0; J < K.length; J++) { G.addStation(K[J]) } }); if ($("#rawLast24:checked").val() != null) { var B = new Date(); B.setDate(B.getDate() - 1); B.setMinutes(0, 0, 0); var F = new Date(); for (var D = new Date(B); D <= F; D.setHours(D.getHours() + 1)) { G.addDate(D) } } else { var A = $("#raw_timeSlider").slider("option", "values"); var B = new Date($("#raw_startDate").val()).setHours(0, 0, 0, 0); var F = new Date($("#raw_endDate").val()).setHours(0, 0, 0, 0); for (var D = new Date(B); D <= F; D.setDate(D.getDate() + 1)) { for (var C = A[0]; C <= A[1]; C++) { D.setHours(C); G.addDate(D) } D.setHours(0, 0, 0, 0) } } var H = G.getStationList().length * G.getDateList().length; if (G.getStationList().length * G.getDateList().length > RAW_MAX_REQUEST) { alert("Your search request is too broad.\nPlease reduce either the Date/Time Range\nor the number of sources (stations)."); showMapPopup("raw", "nav"); return false } $("#txtAllClipsSearchTerms").val(E); $("#txtSearchTerms").val(E); btnTab_Click.call($("#ALL")); togglePopup("raw", "nav", true); searchRaw(G, true) } function renderPageAuthenticated() { if (RL_CurrentUser.Comment != null && RL_CurrentUser.Comment.indexOf("[REDIRECT]") != -1) { window.location = REDIRECT_URL; return } $("#logged_out").hide(); $("#greeting").html("Welcome, " + RL_CurrentUser.FullName); $("#logged_in").show(); var B = RedLasso.Service.ServiceFactory.CreateService("Source"); B.getViewable(function(C) { if (C != null) { RL_ViewableSources = C; renderMap("#localPopup", RL_ViewableSources, false) } }); B.getClippable(function(C) { if (C != null) { RL_ClippableSources = C; renderMap("#rawPopup", RL_ClippableSources, true) } }); var A = RedLasso.Service.ServiceFactory.CreateService("MetaTemplate"); A.get(RL_CurrentUser.Guid, function(C) { RL_MetaTemplate = C }) } function renderPageAnonymous() { $("#logged_in").hide(); $("#logged_out").show(); $("#greeting").html(""); $("#all_tab").click(); playDefault(); var A = RedLasso.Service.ServiceFactory.CreateService("Source"); A.getViewable(function(B) { if (B != null) { RL_ViewableSources = B; renderMap("#localPopup", RL_ViewableSources, false) } }) } function displayUnauthenticatedMessage() { iBox.showURL("overlay/login_splash.htm", "", { width: 615, height: 390 }); lazyFormLoad("#txtLoginEmail", function() { $("#txtLoginEmail").focus() }) } function searchClips(B, A) { var C = (A && A != "") ? A : ""; $("#searchdata .resultsLabel .title").html(C); $("#searchRSS").attr("href", getRssUrl(B)); $("#resultsNavFooter").hide(); $(".resultsNav .prev").unbind().fadeOut(); $(".resultsNav .next").unbind().fadeOut(); $(".resultsNav .pageNumbers").fadeOut(); $(pageElements.get("clipResContainer")).empty(); $("#imgLoading").show(); rlCsc.submitSearchRequest(B, function() { currentPage = 1; pageinator = new RedLasso.Util.Paginator(rlCsc, renderResults, CLIPS_PER_PAGE, PREFETCH_PAGE_COUNT) }) } function renderResults(D) { $("#clipSearchResult_popup").mouseover(function() { hoverFreeze() }); $("#clipSearchResult_popup").mouseout(function() { hover("") }); if (D != null && D.length > 0) { var C = $(".resultsNav .prevPage"); var A = $(".resultsNav .nextPage"); var B = $(".resultsNav .currentPage"); C.unbind(); A.unbind(); B.html(currentPage); if (!pageinator.hasPrev()) { $(".resultsNav .prev").unbind().fadeOut(); C.unbind().empty().css("cursor", "auto") } else { $(".resultsNav .prev").each(function() { var E = $(this); if (E.css("display") == "none" || E.css("opacity") < 1) { E.fadeIn(1000).bind("click", function() { if (navigationEnabled) { currentPage--; pageinator.prev() } }) } }); C.html((currentPage - 1) + " -"); C.bind("click", function() { if (navigationEnabled) { currentPage--; pageinator.prev() } }).css("cursor", "pointer") } if (!pageinator.hasNext()) { $(".resultsNav .next").unbind().fadeOut(); A.empty().unbind().css("cursor", "auto") } else { $(".resultsNav .next").each(function() { var E = $(this); if (E.css("display") == "none" || E.css("opacity") < 1) { E.fadeIn(1000).bind("click", function() { if (navigationEnabled) { currentPage++; pageinator.next() } }) } }); A.html("- " + (currentPage + 1)); A.bind("click", function() { if (navigationEnabled) { currentPage++; pageinator.next() } }).css("cursor", "pointer") } $("#resultsNavFooter").hide(); $(".resultsNav .pageNumbers").hide(); navigationEnabled = false; $(pageElements.get("clipResContainer")).fadeOut(400, function() { $(pageElements.get("clipResContainer")).empty(); $("#imgLoading").fadeOut(); for (var G = 0; G < D.length; G++) { var F = buildClip(D[G]); if (F != null) { var E = $(".thumbimg", F); E.parent().css("cursor", "pointer"); E.parent().click(function() { var I = $(this); var J = I.attr("id").substring(0, I.attr("id").lastIndexOf("_")); $("#RL_Player").empty(); var K = rlCsc.getByGuid(J, function(L) { highlightItem(I); selectClip(L, true) }) }); E.parent().mouseover(function() { var I = $(this); var J = I.attr("id").substring(0, I.attr("id").lastIndexOf("_")); var K = rlCsc.getByGuid(J, function(L) { hover(buildPopup(L), I.children("img")[0]) }) }); E.parent().mouseout(function() { hover("") }); F.css("opacity", "0.0"); $(pageElements.get("clipResContainer")).append(F); var H = clipResultsStartDelay + (G * clipResultsShowOffset); F.pause(H).fade("in", clipResultsStartDelay); navigationEnableTimer = H + clipResultsStartDelay } } navigationEnableTimerHandler = window.setTimeout(function() { navigationEnabled = true }, navigationEnableTimer); $(pageElements.get("clipResContainer")).fadeIn(); $(".resultsNav .pageNumbers").fadeIn(); $("#resultsNavFooter").fadeIn() }) } else { $("#imgLoading").fadeOut(); $("#searchdata .resultsLabel .title").html("No results found for search terms. Please broaden your search.") } } function unhighlightAll() { $(".videodata").each(function(A, B) { unhighlightItem(B) }); $(".thumbnail").each(function(A, B) { unhighlightItem(B) }); $(".featured").each(function(A, B) { unhighlightItem(B) }) } function unhighlightItem(A) { if (!A.css) { A = $(A) } if (A.css("backgroundColor").replace(/ /g, "") == HIGHLIGHT_COLOR) { A.css("backgroundColor", "") } } function highlightItem(A) { unhighlightAll(); A.animate({ backgroundColor: HIGHLIGHT_COLOR }) } function rlHeartBeat() { return "ThumpThump" }

function createClipMeta(F, E, C, I, A, D, H, G) {
    if (RL_MetaTemplate != null)
    { var B = RedLasso.Service.ServiceFactory.CreateService("Clip"); B.get(new Array(H), function(K) { if (K.length > 0) { var J = new RedLasso.Domain.Clip(K[0]); btnEditClipInfo_Click(J) } }) }
} 
 
 var capAds = [{ src: "Facebook.png", action: "http://www.facebook.com/pages/Redlasso/87549246301" }, { src: "RL_Blog.png", action: "http://blog.redlasso.com" }, { src: "Twitter.png", action: "http://twitter.com/redlasso" }, { src: "clipped.png", action: "$('#raw_tab').click(); return false;" }, { src: "howto.png", action: "playDefault(); return false;"}]; function showCapAd() { var C = $("#rotate_ad"); var A = Math.floor(Math.random() * capAds.length); var D = capAds[A]; var B = '<a style="text-decoration: none"'; if (D.action.substring(0, 4) == "http") { B += ' href="' + D.action + '" target="_blank">' } else { B += ' href="javascript: null" onclick="' + D.action + '">' } B += '<img style="border: 0" src="images/caption_ads/' + D.src + '" /></a>'; C[0].innerHTML = B; C.show() } function hideCapAd() { $("#rotate_ad").hide() } function playDefault() { var A = RedLasso.Service.ServiceFactory.CreateService("Clip"); A.get(new Array(DEFAULT_CLIP), function(B) { selectClip(new RedLasso.Domain.Clip(B[0])) }) } function openRSS() { RSSMarketListState = null; iBox.showURL("overlay/rss.html", "Generate RSS", { width: 500, height: 350 }); lazyFormLoad("#feedMarket", populateMarkets) } function clearContent(A) { var B = (window.event) ? $(window.event.srcElement) : $(A.target); if (B.hasClass("noInput")) { B.removeClass("noInput"); B.val(""); B.focus() } } function rssTitle() { var A = $("#feedTitle"); if (A.val() == "enter feed title" || A.val() == "") { $("#chkFeedTitle").attr("checked", false); A.val("enter feed title"); A.addClass("noInput") } else { $("#chkFeedTitle").attr("checked", true) } } function rssKeywords() { var A = $("#feedKeywords"); if (A.val() == "enter keywords" || A.val() == "") { $("#chkFeedKeywords").attr("checked", false); A.val("enter keywords"); A.addClass("noInput") } else { $("#chkFeedKeywords").attr("checked", true) } } function rssCategory() { if ($("#feedCategory").val() != "") { $("#chkFeedCategory").attr("checked", true) } else { $("#chkFeedCategory").attr("checked", false) } } function rssMarket() { if ($("#feedMarket").val() != "") { $("#chkFeedMarket").attr("checked", true) } else { $("#chkFeedMarket").attr("checked", false) } } function populateMarkets() { if (RSSMarketListState == null) { RSSMarketListState = -1; $("#feedMarketLoading").show(); lazyFormLoadObject(RL_ViewableSources, function() { var I = $("#feedMarket")[0]; var J = $("#feedMarketLoading")[0]; var F = document.createElement("option"); F.value = ""; F.appendChild(document.createTextNode("Select a Market")); while (I.hasChildNodes()) { I.removeChild(I.firstChild) } I.appendChild(F); for (var E in RL_ViewableSources) { var G = RL_ViewableSources[E]; if (G.RegionID) { thisGroup = document.createElement("optgroup"); thisGroup.label = G.RegionID; for (var D in G.Markets) { var C = G.Markets[D]; var A = ""; for (var B in C.Stations) { if (B != "undefined") { A += C.Stations[B].id + " " } } if (A != "") { var H = document.createElement("option"); H.value = A; H.appendChild(document.createTextNode(C.Name)); thisGroup.appendChild(H) } } I.appendChild(thisGroup) } } $(J).hide(); RSSMarketListState = 1 }, 60, 1000) } } function generateRSS() { var D = RedLasso.Util.ScriptVars.SvcPrefix + "svc/rss/getClipRss"; var B = ""; if ($("#chkFeedTitle")[0].checked) { B += "&ti=" + $("#feedTitle").val() } if ($("#chkFeedKeywords")[0].checked) { B += "&st=" + $("#feedKeywords").val() } var A = ""; if ($("#chkFeedCategory")[0].checked) { A += "{'k': 'category', 'v': '" + $("#feedCategory").val() + "'}," } if ($("#chkFeedMarket")[0].checked) { var C = $("#feedMarket").val(); A += "{'k': 'stationid', 'v': '" + C.substring(0, C.length - 1) + "'}," } if (A != "") { A = A.substring(0, A.length - 1); B += "&kv=[" + A + "]" } if (B != "") { D += "?" + B.substring(1) } $("#generatedRSS").val(D) };