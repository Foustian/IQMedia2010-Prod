@using IQMedia.Model;
@model IQMedia.Model.IQArchive_DisplayLibraryReport
@{ 
    string BaseUrl = Request.Url.Scheme + "://" + Request.Url.Host + "/";
    string ImageBaseUrl = Request.Url.Scheme + "://" + Request.Url.Host + "/images/"; 
}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>iQ media Report</title>
    <style type="text/css">
        .highlight
        {
            color: blue;
            font-weight: bold;
            font-style: italic;
        }
        .mediatitle
        {
            background-color: #EAEAEA;
            font-weight: bold;
            font-size: 15px;
            border: 1px solid #A0A0A0;
            padding-top: 4px;
            padding-bottom: 4px;
            padding-left: 10px;
        }
        .categorytitle
        {
            line-height: 25px;
            font-weight: bold;
            font-size: 14px;
            padding-bottom: 5px;
            border-bottom: 1px solid #A0A0A0;
        }
    </style>
</head>
<body>
    <div style="font-family: 'Microsoft Sans Serif'; padding-top: 10px; padding-bottom: 10px;">
        ##UserMessage##
    </div>
    <br />
    @if (Model != null && Model.ReportDetails != null && Model.ArchiveResults != null)
    {
        SessionInformation sessionInformation = IQMedia.WebApplication.Utility.CommonFunctions.GetSessionInformation();
        string Logo = System.Configuration.ConfigurationManager.AppSettings["UrlReportHeader"];
        Logo += sessionInformation.ClientGUID + "/" + Model.ReportDetails._ReportImage;

        List<IQArchive_ArchiveClipModel> lstIQArchive_ArchiveClipModel = (List<IQArchive_ArchiveClipModel>)Model.ArchiveResults.Where(w => string.Compare(w.MediaType, "TV", true) == 0).Select(s => new IQArchive_ArchiveClipModel()
        {
            ClipID = s.MediaData.ClipID,
            ClosedCaption = s.MediaData.ClosedCaption,
            IQAdShareValue = s.MediaData.IQAdShareValue == null ? 0 : s.MediaData.IQAdShareValue,
            Market = s.MediaData.Market,
            Nielsen_Audience = s.MediaData.Nielsen_Audience == null ? 0 : s.MediaData.Nielsen_Audience,
            Nielsen_Result = s.MediaData.Nielsen_Result,
            StationLogo = s.MediaData.StationLogo,
            National_Nielsen_Audience = s.MediaData.National_Nielsen_Audience,
            National_IQAdShareValue = s.MediaData.National_IQAdShareValue
        }).ToList();

        List<IQArchive_ArchiveNMModel> lstIQArchive_ArchiveNMModel = (List<IQArchive_ArchiveNMModel>)Model.ArchiveResults.Where(w => string.Compare(w.MediaType, "NM", true) == 0).Select(s => new IQArchive_ArchiveNMModel()
        {
            Compete_Audience = s.MediaData.Compete_Audience == null ? 0 : s.MediaData.Compete_Audience,
            Compete_Result = s.MediaData.Compete_Result,
            IQAdShareValue = s.MediaData.IQAdShareValue == null ? 0 : s.MediaData.IQAdShareValue,
            Publication = s.MediaData.Publication,
            Url = s.MediaData.Url
        }).ToList();

        List<IQArchive_ArchiveSMModel> lstIQArchive_ArchiveSMModel = (List<IQArchive_ArchiveSMModel>)Model.ArchiveResults.Where(w => string.Compare(w.SubMediaType.ToString(), "Blog", true) == 0).Select(s => new IQArchive_ArchiveSMModel()
        {
            Compete_Audience = s.MediaData.Compete_Audience == null ? 0 : s.MediaData.Compete_Audience,
            Compete_Result = s.MediaData.Compete_Result,
            IQAdShareValue = s.MediaData.IQAdShareValue == null ? 0 : s.MediaData.IQAdShareValue,
            Publication = s.MediaData.Publication,
            Url = s.MediaData.Url
        }).ToList();

        List<IQArchive_ArchiveTweetsModel> lstIQArchive_ArchiveTweetsModel = (List<IQArchive_ArchiveTweetsModel>)Model.ArchiveResults.Where(w => string.Compare(w.MediaType, "TW", true) == 0).Select(s => new IQArchive_ArchiveTweetsModel()
        {
            ActorDisplayname = s.MediaData.ActorDisplayname,
            ActorImage = s.MediaData.ActorImage,
            FollowersCount = s.MediaData.FollowersCount,
            FreiendsCount = s.MediaData.FreiendsCount,
            KloutScore = s.MediaData.KloutScore,
            PreferredUserName = s.MediaData.PreferredUserName
        }).ToList();

        List<IQArchive_ArchiveBLPMModel> lstIQArchive_ArchiveBLPMModel = (List<IQArchive_ArchiveBLPMModel>)Model.ArchiveResults.Where(w => string.Compare(w.MediaType, "PM", true) == 0).Select(s => new IQArchive_ArchiveBLPMModel()
        {
            Circulation = s.MediaData.Circulation
        }).ToList();


        long TVNationalAudience = lstIQArchive_ArchiveClipModel.Sum(sm => sm.National_Nielsen_Audience.HasValue && sm.National_Nielsen_Audience > 0 ? Convert.ToInt64(sm.National_Nielsen_Audience.Value) : 0);
        long TVAudience = lstIQArchive_ArchiveClipModel.Sum(sm => Convert.ToInt64(sm.Nielsen_Audience.Value));
        long NMAudience = lstIQArchive_ArchiveNMModel.Sum(sm => Convert.ToInt64(sm.Compete_Audience.Value));
        long SMAudience = lstIQArchive_ArchiveSMModel.Sum(sm => Convert.ToInt64(sm.Compete_Audience.Value));
        long TWAudience = lstIQArchive_ArchiveTweetsModel.Sum(sm => Convert.ToInt64(sm.FollowersCount));
        long PMAudience = lstIQArchive_ArchiveBLPMModel.Sum(sm => Convert.ToInt64(sm.Circulation));

        decimal TVNationalValue = lstIQArchive_ArchiveClipModel.Sum(sm => sm.National_IQAdShareValue.HasValue && sm.National_IQAdShareValue > 0 ? sm.National_IQAdShareValue.Value : 0);
        decimal TVValue = lstIQArchive_ArchiveClipModel.Sum(sm => sm.IQAdShareValue.Value);
        decimal NMValue = lstIQArchive_ArchiveNMModel.Sum(sm => sm.IQAdShareValue.Value);
        decimal SMValue = lstIQArchive_ArchiveSMModel.Sum(sm => sm.IQAdShareValue.Value);

        
        Int64 totalAudience = (TVAudience < 0 || !sessionInformation.IsNielsenData ? 0 : TVAudience) +
            (NMAudience < 0 || !sessionInformation.IsCompeteData ? 0 : NMAudience) +
            (SMAudience < 0 || !sessionInformation.IsCompeteData ? 0 : SMAudience) +
            (TWAudience < 0 ? 0 : TWAudience) +
            (PMAudience < 0 ? 0 : PMAudience);


        decimal totalMediaValue = (TVValue < 0 || !sessionInformation.IsNielsenData ? 0 : TVValue) +
            (NMValue < 0 || !sessionInformation.IsCompeteData ? 0 : NMValue) +
                (SMValue < 0 || !sessionInformation.IsCompeteData ? 0 : SMValue);
                
        <table style="background-color: #ffffff; width: 650px; border: solid 1px #dadada;
            padding: 3px 3px 3px 3px;" width="650px" align="center">
            <tr>
                <td>
                    <table style="width: 100%">
                        <tr>
                            <td id="divLogo">
                                @if (!string.IsNullOrEmpty(Model.ReportDetails._ReportImage))
                                {
                                    <img src="@Logo" alt="logo" />
                                }
                                else
                                {
                                    <img src="@(ImageBaseUrl + "logo_N.png")" alt="iq logo" />
                                }
                            </td>
                        </tr>
                        <tr>
                            <td width="285px" style="text-align: right;">
                                @if (Model.ReportDetails.Settings.ShowTotalNationalAudience)
                                {
                                    <text>Total National Audience :
                                    @string.Format("{0:N0}", TVNationalAudience)
                                    <br />
                                    </text>
                                }
                                @if (Model.ReportDetails.Settings.ShowTotalNationalMediaValue)
                                {
                                    <text> National Media Value : $ 
                                    @string.Format("{0:N2}", TVNationalValue)
                                    <br />
                                    </text>
                                }
                                @if (Model.ReportDetails.Settings.ShowTotalAudience)
                                {
                                    <text>Total Audience :
                                    @string.Format("{0:N0}", totalAudience)
                                    <br />
                                    </text>
                                }
                                @if (Model.ReportDetails.Settings.ShowTotalMediaValue)
                                {
                                    <text> Media Value : $
                                    @string.Format("{0:N2}", totalMediaValue)
                                    </text>
                                }
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td id="divReportTitle" style="font-family: 'Microsoft Sans Serif'; padding-top: 15px;
                    padding-bottom: 15px;">
                    <h4>@Model.ReportDetails.Title</h4>
                </td>
            </tr>
            <tr>
                <td>
                    ##DashboardCharts##
                </td>
            </tr>
            @if (Model.ReportDetails.Settings.ShowCoverageSources)
            {
            <tr>
                <td style="padding: 15px 0px 15px 25px;">
                    <!-- Primary group summary -->
                    <table id="tblSourceSummary">
                        @foreach (KeyValuePair<string, int> kvp in Model.GroupTier1Counts)
                        {
                            if (kvp.Value > 0)
                            {
                                <tr>
                                    <td style="font-family: 'Microsoft Sans Serif';">
                                        @kvp.Key - @kvp.Value
                                    </td>
                                </tr>
                            }
                        }
                    </table>
                </td>
            </tr>
            }
            <tr>
                <td>
                    <table style="width: 100%">
                        <!-- Generate media items for primary and secondary groups -->
                        @foreach (IQArchive_GroupTier1Model groupTier1 in Model.GroupTier1Results)
                        {
                            if (Model.GroupTier1Counts[groupTier1.GroupName] > 0)
                            {
                            <tr>
                                <td>
                                    <table style="width: 100%;">
                                        <tr>
                                            <td style="font-family: 'Microsoft Sans Serif';" class="mediatitle">
                                                @groupTier1.GroupName
                                            </td>
                                        </tr>
                                        @{                                 
                                            <tr>
                                                <td>
                                                    <table style="width:100%;">
                                                        @if (Model.ReportDetails.Settings.ShowAudience)
                                                        {
                                                            <tr>
                                                                <td align="right">
                                                                    Audience: @groupTier1.TotalAudience.ToString("N0")
                                                                </td>
                                                            </tr>
                                                        }
                                                        @if (Model.ReportDetails.Settings.ShowMediaValue)
                                                        {
                                                            <tr>
                                                                <td align="right">
                                                                    Media Value: $ @groupTier1.TotalMediaValue.ToString("N2")
                                                                </td>
                                                            </tr>
                                                            
                                                        }
                                                    </table>
                                                </td>
                                            </tr>
                                        }

                                    @if (groupTier1.GroupTier2Counts != null && groupTier1.GroupTier2Counts.Count > 0)
                                    { 
                                        <tr>
                                            <td style="padding-top: 10px; padding-bottom: 5px;">
                                                <table>
                                        @foreach (KeyValuePair<string, int> kvp in groupTier1.GroupTier2Counts)
                                        {
                                            if (kvp.Value > 0)
                                            {
                                                        <tr>
                                                            <td style="font-family: 'Microsoft Sans Serif';">
                                                                @kvp.Key - @kvp.Value
                                                            </td>
                                                        </tr>
                                            }
                                        }
                                                </table>
                                            </td>
                                        </tr>
                                    }
                                        <tr>
                                            <td style="padding-top: 5px; padding-bottom: 10px;">
                                                @foreach (IQArchive_GroupTier2Model groupTier2 in groupTier1.GroupTier2Results)
                                                {
                                                    if (groupTier2.ArchiveResults.Count > 0)
                                                    {
                                                    <br />        
                                                    if (groupTier2.IsEnabled)
                                                    {
                                                        <div class="categorytitle" style="font-family: 'Microsoft Sans Serif';">@groupTier2.GroupName</div>
                                                        <br />
                                                    }

                                                    foreach (IQMedia.Model.IQArchive_MediaModel item in groupTier2.ArchiveResults)
                                                    {
                                                        string Month = item.MediaDate != null ? item.MediaDate.ToString("MMM", System.Globalization.CultureInfo.InvariantCulture) : string.Empty;
                                                        string Day = item.MediaDate != null ? item.MediaDate.Day.ToString() : string.Empty;
                                                        string Time = item.MediaDate != null ? item.MediaDate.ToString("hh:mm tt") : string.Empty;

                                                        switch (item.SubMediaType)
                                                        {
                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.TV:

                                                                IQArchive_ArchiveClipModel TVModel = item.MediaData as IQArchive_ArchiveClipModel;

                                                                string TVThumbUrl = Convert.ToString(System.Configuration.ConfigurationManager.AppSettings["IQArchieve_TVThumbUrl"]);
                                                                TVThumbUrl += TVModel.ClipID;

                                                                Month = TVModel.LocalDateTime != null ? TVModel.LocalDateTime.ToString("MMM", System.Globalization.CultureInfo.InvariantCulture) : string.Empty;
                                                                Day = TVModel.LocalDateTime != null ? TVModel.LocalDateTime.Day.ToString() : string.Empty;
                                                                Time = TVModel.LocalDateTime != null ? TVModel.LocalDateTime.ToString("hh:mm tt") : string.Empty;

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @TVModel.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/network-icon.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.TV)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td class="minHeight32" valign="top">
                                                                            <img alt="" src="@TVModel.StationLogo" />
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table style="width: 100%">
                                                                                <tr>
                                                                                    <td>
                                                                                        <table cellspacing="0" cellpadding="0" style="width: 100%">
                                                                                            <tr>
                                                                                                <td valign="top" style="font-family: 'Microsoft Sans Serif'">
                                                                                                    <span style="font-family: 'Microsoft Sans Serif'; margin-left: 10px; margin-bottom: 0px;
                                                                                                        font-size: 14px;"><span style="vertical-align: top; font-family: 'Microsoft Sans Serif'">@item.Title</span>
                                                                                                    </span>
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif';">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(TVModel.Market))
                                                                                            {
                                                                                                <span style="color: #73797F;">@TVModel.Market
                                                                                                    - </span>
                                                                                            }
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td valign="top" align="right">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <a href="@(BaseUrl + "ClipPlayer/?ClipID=" + TVModel.ClipID)">
                                                                                            <img width="130" height="auto" style="width: 130px;height:auto;" src="@TVThumbUrl" alt="clip"/>
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height:@(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px");">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 90px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((TVModel.NegativeSentiment * 6) > 25 ? 25 : (TVModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(TVModel.NegativeSentiment > 0 ? TVModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((TVModel.PositiveSentiment * 6) > 25 ? 25 : (TVModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(TVModel.PositiveSentiment > 0 ? TVModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 180px;">
                                                                            @if (TVModel.Nielsen_Audience > 0 && TVModel.IQAdShareValue > 0 && sessionInformation.IsNielsenData)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tr>
                                                                                        @if (Model.ReportDetails.Settings.ShowAudience)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "view.png")" alt="view" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @( TVModel.Nielsen_Audience.HasValue ? string.Format("{0:n0}", TVModel.Nielsen_Audience) : string.Empty)
                                                                                            </td>
                                                                                        }
                                                                                        @if (Model.ReportDetails.Settings.ShowMediaValue)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "dollar.png")" alt="dollar" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (TVModel.IQAdShareValue.HasValue)
                                                                                                {
                                                                                                    <table cellpadding="0" cellspacing="0">
                                                                                                        <tr>
                                                                                                            <td style="font-family: 'Microsoft Sans Serif';">@(string.Format("{0:n2}", TVModel.IQAdShareValue))
                                                                                                            </td>
                                                                                                            @if (!string.IsNullOrWhiteSpace(TVModel.Nielsen_Result))
                                                                                                            {
                                                                                                                <td style="font-family: 'Microsoft Sans Serif';">
                                                                                                                    &nbsp;@("(" + TVModel.Nielsen_Result.ToUpper() + ")")
                                                                                                                </td>
                                                                                                            }
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                </table>
                                                                            }
                                                                            else
                                                                            {
                                                                                if (Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue && sessionInformation.IsNielsenData)
                                                                                {
                                                                                <div style="height: 15px">
                                                                                    &nbsp;</div>
                                                                                }
                                                                            }
                                                                        </td>
                                                                        <td style="width: 180px;">
                                                                            @if (Model.ReportDetails.Settings.ShowNationalValues && sessionInformation.IsNielsenData)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tr>
                                                                                        @if (TVModel.National_Nielsen_Audience.HasValue)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "us-map.png")" alt="view" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @( TVModel.National_Nielsen_Audience.HasValue ? string.Format("{0:n0}", TVModel.National_Nielsen_Audience) : string.Empty)
                                                                                            </td>
                                                                                        }
                                                                                        @if (TVModel.National_IQAdShareValue.HasValue)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "us-dollar.png")" alt="dollar" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (TVModel.National_IQAdShareValue.HasValue)
                                                                                                {
                                                                                                    <table cellpadding="0" cellspacing="0">
                                                                                                        <tr>
                                                                                                            <td style="font-family: 'Microsoft Sans Serif';">@(string.Format("{0:n2}", TVModel.National_IQAdShareValue))
                                                                                                            </td>
                                                                                                            @if (!string.IsNullOrWhiteSpace(TVModel.National_Nielsen_Result))
                                                                                                            {
                                                                                                                <td style="font-family: 'Microsoft Sans Serif';">
                                                                                                                    &nbsp;@("(" + TVModel.National_Nielsen_Result.ToUpper() + ")")
                                                                                                                </td>
                                                                                                            }
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                    
                                                                            break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.TW:

                                                                            IQArchive_ArchiveTweetsModel twitterModel = item.MediaData as IQArchive_ArchiveTweetsModel;

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; background-color: #EEEEEE; color: #fff;
                                                                                        width: 75px; height: auto; text-align: center; padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/twitter.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.TW)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        @{
                                                                                                                                             string actorlink = string.Empty;
                                                                                                                                             if (IQMedia.Shared.Utility.CommonFunctions.Validate_url(twitterModel.ActorLink + "/status/" + twitterModel.TweetID))
                                                                                                                                             {
                                                                                                                                                 actorlink = twitterModel.ActorLink + "/status/" + twitterModel.TweetID;
                                                                                                                                             }
                                                                                        }
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@actorlink" target="_blank" style="color: #333333;">@twitterModel.ActorDisplayname</a>
                                                                                            &nbsp;&nbsp;<span style="font-family: 'Microsoft Sans Serif'; font-size: 11px; color: #999999">@@
                                                                                                (@twitterModel.PreferredUserName)</span></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr style="padding: 1% 0%;">
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        @Html.Raw(item.DisplayText)
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td valign="top" style="width: 50px;" align="right">
                                                                            <img src="@twitterModel.ActorImage" width="50" alt="actor image" />
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                    line-height: 20px; width: 100%;">
                                                                    <tr style="height: 20px; background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 90px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((twitterModel.NegativeSentiment * 6) > 25 ? 25 : (twitterModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(twitterModel.NegativeSentiment > 0 ? twitterModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px; overflow: hidden">
                                                                                                                <span style="width:@((twitterModel.PositiveSentiment * 6) > 25 ? 25 : (twitterModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(twitterModel.PositiveSentiment > 0 ? twitterModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td>
                                                                            <table cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                                line-height: 20px; text-align: center;">
                                                                                <tr>
                                                                                    <td style="font-family: 'Microsoft Sans Serif';">
                                                                                        <img src="@(ImageBaseUrl + "Klout.png")" alt="Klout Score" />
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", twitterModel.KloutScore))
                                                                                    </td>
                                                                                    @if (Model.ReportDetails.Settings.ShowAudience)
                                                                                    {
                                                                                        <td style="font-family: 'Microsoft Sans Serif';">
                                                                                            <img src="@(ImageBaseUrl + "followers.png")" alt="Followers" />
                                                                                        </td>
                                                                                    }
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", twitterModel.FollowersCount))
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif';">
                                                                                        <img src="@(ImageBaseUrl + "following.png")" alt="Following" />
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", twitterModel.FreiendsCount))
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td align="right">
                                                                            &nbsp;
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                                                                                                                                          break;


                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.NM:

                                                                                                                                                                          IQArchive_ArchiveNMModel newsMediaModel = item.MediaData as IQArchive_ArchiveNMModel;
                
                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/News.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.NM)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            @if (newsMediaModel.IQLicense == 3)
                                                                                            {
                                                                                                <img src="@(ImageBaseUrl + "MediaIcon/LexisNexis_Small.png")" title="LexisNexis(R)" alt="LexisNexis(R)" />
                                                                                            }
                                                                                            <a href="@(newsMediaModel.IQLicense > 0 ? "http://" + Request.ServerVariables["HTTP_HOST"] + Url.Action("Index", "Article", new { au = IQMedia.Shared.Utility.CommonFunctions.EncryptLicenseStringAES(sessionInformation.CustomerKey + "¶Library Report Email¶" + newsMediaModel.Url + "&u1=cliq40&u2=" + sessionInformation.ClientID + "¶" + newsMediaModel.IQLicense) }) : newsMediaModel.Url)" target="_blank"
                                                            style="color: #333333;">@Html.Raw(item.Title)</a></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(newsMediaModel.Publication))
                                                                                            {
                                                                                                <span style="color: #73797F;">@newsMediaModel.Publication
                                                                                                    - </span>}
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); background-color: #F4F4F4;">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((newsMediaModel.NegativeSentiment * 6) > 25 ? 25 : (newsMediaModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(newsMediaModel.NegativeSentiment > 0 ? newsMediaModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((newsMediaModel.PositiveSentiment * 6) > 25 ? 25 : (newsMediaModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(newsMediaModel.PositiveSentiment > 0 ? newsMediaModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                            @if (Decimal.Compare(Convert.ToDecimal(newsMediaModel.IQAdShareValue), -1M) != 0 && newsMediaModel.Compete_Audience != -1 && sessionInformation.IsCompeteData)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tr>
                                                                                        @if (Model.ReportDetails.Settings.ShowAudience)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "view.png")" alt="view" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (newsMediaModel.Compete_Audience.HasValue)
                                                                                                {
                                                                                                    @(string.Format("{0:n0}", newsMediaModel.Compete_Audience))
                                                       
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @("NA")
                                                                                                }
                                                                                                @if (!string.IsNullOrWhiteSpace(newsMediaModel.Compete_Result) && newsMediaModel.Compete_Result.ToUpper() == "A")
                                                                                                {
                                                                                                    <img title="Powered by Compete" width="14" height="auto" style="width: 14px;height:auto;" src="@(ImageBaseUrl + "compete.png")" alt="Compete Image" />
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                        @if (Model.ReportDetails.Settings.ShowMediaValue)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "dollar.png")" alt="dollar" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (newsMediaModel.IQAdShareValue.HasValue)
                                                                                                {
                                                                                                    @(string.Format("{0:n2}", newsMediaModel.IQAdShareValue))
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @("NA")
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td align="right">
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>


                                                                            break;


                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.PM:

                                                                            string PMBasePath = Convert.ToString(System.Configuration.ConfigurationManager.AppSettings["IQArchieve_PMBaseUrl"]);
                                                                            IQArchive_ArchiveBLPMModel PMModel = item.MediaData as IQArchive_ArchiveBLPMModel;

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/print-media.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.PM)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table style="width: 100%">
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a style="color: #333333;" href="@(PMBasePath + PMModel.FileLocation.Replace(@"\", @"/"))"
                                                        target="_blank">@Html.Raw(item.Title)</a></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr style="padding: 1% 0%;">
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="color: #73797F;">@PMModel.Pub_Name</span> - @Html.Raw(item.DisplayText)
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        @if (Model.ReportDetails.Settings.ShowAudience)
                                                        {
                                                            <tr style="height: 20px; background-color: #F4F4F4;">
                                                                <td style="padding: 0;">
                                                                    <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: 20px; width: 100%;">
                                                                        <tr style="height: 20px; background-color: #F4F4F4;">
                                                                            <td style="width: 80px;">
                                                                            </td>
                                                                            <td style="width: 160px;">
                                                                                <table cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                                    line-height: 20px; text-align: center;">
                                                                                    <tr>
                                                                                        <td style="font-family: 'Microsoft Sans Serif';">
                                                                                            Circulation:
                                                                                        </td>
                                                                                        <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">@(string.Format("{0:n0}", PMModel.Circulation))
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                            <td align="right">
                                                                                &nbsp;
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        }
                                                    </table>


                                                        break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.SocialMedia:

                                                        IQArchive_ArchiveSMModel socialMediaModel = item.MediaData as IQArchive_ArchiveSMModel;
                                              
                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/social-media.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.SocialMedia)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@socialMediaModel.Url" target="_blank"
                                                            style="color: #333333;">@Html.Raw(item.Title)</a></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(socialMediaModel.Publication))
                                                                                            {
                                                                                                <span style="color: #73797F;">@socialMediaModel.Publication
                                                                                                    - </span>
                                                                                            }
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px");background-color: #F4F4F4;">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((socialMediaModel.NegativeSentiment * 6) > 25 ? 25 : (socialMediaModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(socialMediaModel.NegativeSentiment > 0 ? socialMediaModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((socialMediaModel.PositiveSentiment * 6) > 25 ? 25 : (socialMediaModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(socialMediaModel.PositiveSentiment > 0 ? socialMediaModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                        </td>
                                                                        <td align="right">
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                                            break;
                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.Forum:

                                                                            IQArchive_ArchiveSMModel forumModel = item.MediaData as IQArchive_ArchiveSMModel;
                    
                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/forum.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.Forum)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@forumModel.Url" target="_blank"
                                                            style="color: #333333;">@Html.Raw(item.Title)</a></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(forumModel.Publication))
                                                                                            {
                                                                                                <span style="color: #73797F;">@forumModel.Publication
                                                                                                    - </span>}
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); background-color: #F4F4F4;">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((forumModel.NegativeSentiment * 6) > 25 ? 25 : (forumModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(forumModel.NegativeSentiment > 0 ? forumModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((forumModel.PositiveSentiment * 6) > 25 ? 25 : (forumModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(forumModel.PositiveSentiment > 0 ? forumModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                        </td>
                                                                        <td align="right">
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                                            break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.Blog:

                                                                            IQArchive_ArchiveSMModel blogModel = item.MediaData as IQArchive_ArchiveSMModel;

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/blog.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.Blog)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@blogModel.Url" target="_blank"
                                                            style="color: #333333;">@Html.Raw(item.Title)</a></span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(blogModel.Publication))
                                                                                            {
                                                                                                <span style="color: #73797F;">@blogModel.Publication
                                                                                                    - </span>
                                                                                            }
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); background-color: #F4F4F4;">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                        line-height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment || Model.ReportDetails.Settings.ShowAudience || Model.ReportDetails.Settings.ShowMediaValue ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((blogModel.NegativeSentiment * 6) > 25 ? 25 : (blogModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(blogModel.NegativeSentiment > 0 ? blogModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((blogModel.PositiveSentiment * 6) > 25 ? 25 : (blogModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(blogModel.PositiveSentiment > 0 ? blogModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                            @if (Decimal.Compare(Convert.ToDecimal(blogModel.IQAdShareValue), -1M) != 0 && blogModel.Compete_Audience != -1 && sessionInformation.IsCompeteData)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tr>
                                                                                        @if (Model.ReportDetails.Settings.ShowAudience)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "view.png")" alt="view" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (blogModel.Compete_Audience.HasValue)
                                                                                                {
                                                                                                    @(string.Format("{0:n0}", blogModel.Compete_Audience))
                                                       
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @("NA")
                                                                                                }
                                                                                                @if (!string.IsNullOrWhiteSpace(blogModel.Compete_Result) && blogModel.Compete_Result.ToUpper() == "A")
                                                                                                {
                                                                                                    <img title="Powered by Compete" width="14" height="auto" style="width: 14px;height:auto;" src="@(ImageBaseUrl + "compete.png")" alt="Compete Image" />
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                        @if (Model.ReportDetails.Settings.ShowMediaValue)
                                                                                        {
                                                                                            <td>
                                                                                                <img src="@(ImageBaseUrl + "dollar.png")" alt="dollar" />
                                                                                            </td>
                                                                                            <td style="padding-left: 10px; padding-right: 15px; font-family: 'Microsoft Sans Serif';">
                                                                                                @if (blogModel.IQAdShareValue.HasValue)
                                                                                                {
                                                                                                    @(string.Format("{0:n2}", blogModel.IQAdShareValue))
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @("NA")
                                                                                                }
                                                                                            </td>
                                                                                        }
                                                                                    </tr>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td align="right">
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                                            break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.FB:

                                                                            IQArchive_ArchiveSMModel fbModel = item.MediaData as IQArchive_ArchiveSMModel;

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; background-color: #EEEEEE; color: #fff;
                                                                                        width: 75px; height: auto; text-align: center; padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @sessionInformation.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/facebook.png")" alt="Facebook" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@fbModel.Url" target="_blank" style="color: #333333;">@item.Title</a>
                                                                                            <img src="@(ImageBaseUrl + "arrow-plain.png")" style="padding:0px 5px;" />
                                                                                            &nbsp;
                                                                                            <span style="color: #999999">@fbModel.Publication</span>
                                                                                            @if (fbModel.ArticleStats != null && fbModel.ArticleStats.IsVerified)
                                                                                            {
                                                                                                <img src="@(ImageBaseUrl + "blue-check.png")" />
                                                                                            }
                                                                                    </td>
                                                                                </tr>
                                                                                <tr style="padding: 1% 0%;">
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        @Html.Raw(item.DisplayText)
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td valign="top" style="width: 50px;" align="right">
                                                                            <img src="@fbModel.ThumbUrl" width="50" alt="post image" />
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                    line-height: 20px; width: 100%;">
                                                                    <tr style="height: 20px; background-color: #F4F4F4;">
                                                                        <td style="width: 80px;"></td>
                                                                        @if (fbModel.ArticleStats != null)
                                                                        {
                                                                        <td>
                                                                            <table cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif'; height: 20px; text-align: center;">
                                                                                <tr>
                                                                                    <td style="font-family: 'Microsoft Sans Serif';">
                                                                                        <img src="@(ImageBaseUrl + "fb-like.png")" alt="Likes" />
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", fbModel.ArticleStats.Likes))
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif';">
                                                                                        <img src="@(ImageBaseUrl + "fb-comment.png")" alt="Comments" />
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", fbModel.ArticleStats.Comments))
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif';">
                                                                                        <img src="@(ImageBaseUrl + "fb-share.png")" alt="Shares" />
                                                                                    </td>
                                                                                    <td style="font-family: 'Microsoft Sans Serif'; padding-left: 10px; padding-right: 15px;">@(string.Format("{0:n0}", fbModel.ArticleStats.Shares))
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        }
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                                        break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.Radio:
                                                                        IQArchive_ArchiveTVEyesModel TVEyesModel = item.MediaData as IQArchive_ArchiveTVEyesModel;
                                                                        Month = TVEyesModel.LocalDateTime != null ? TVEyesModel.LocalDateTime.ToString("MMM", System.Globalization.CultureInfo.InvariantCulture) : string.Empty;
                                                                        Day = TVEyesModel.LocalDateTime != null ? TVEyesModel.LocalDateTime.Day.ToString() : string.Empty;
                                                                        Time = TVEyesModel.LocalDateTime != null ? TVEyesModel.LocalDateTime.ToString("hh:mm tt") : string.Empty;
                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @TVEyesModel.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/radio.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.Radio)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td class="minHeight32" valign="top" style="color: Red; font-size: 13px; word-wrap: break-word;
                                                                            word-break: break-all;">
                                                                             @TVEyesModel.StationID
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table style="width: 100%">
                                                                                <tr>
                                                                                    <td>
                                                                                        <table cellspacing="0" cellpadding="0" style="width: 100%">
                                                                                            <tr>
                                                                                                <td valign="top" style="font-family: 'Microsoft Sans Serif'">
                                                                                                    <span style="font-family: 'Microsoft Sans Serif'; margin-left: 10px; margin-bottom: 0px;
                                                                                                        font-size: 14px;"><span style="vertical-align: top; font-family: 'Microsoft Sans Serif'"><a style="color: #333333;" target="_blank" href="@(System.Configuration.ConfigurationManager.AppSettings["RadioClipPlayerURL"] + Url.Encode(IQMedia.Shared.Utility.CommonFunctions.GenerateRandomString() + IQMedia.Shared.Utility.CommonFunctions.EncryptStringAES(item.ID.ToString(), IQMedia.Shared.Utility.CommonFunctions.AesKeyLibRadioPlayer, IQMedia.Shared.Utility.CommonFunctions.AesIVLibRadioPlayer)))">@item.Title</a></span>
                                                                                                    </span>
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif';">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @if (!string.IsNullOrWhiteSpace(TVEyesModel.Market))
                                                                                            {
                                                                                                <span style="color: #73797F;">@TVEyesModel.Market
                                                                                                    - </span>
                                                                                            }
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif';
                                                                    line-height: 20px; width: 100%;">
                                                                    <tr style="height: 20px; background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((TVEyesModel.NegativeSentiment * 6) > 25 ? 25 : (TVEyesModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(TVEyesModel.NegativeSentiment > 0 ? TVEyesModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((TVEyesModel.PositiveSentiment * 6) > 25 ? 25 : (TVEyesModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(TVEyesModel.PositiveSentiment > 0 ? TVEyesModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                            @if (!string.IsNullOrEmpty(TVEyesModel.DMARank))
                                                                            {
                                                                                <span>Market Rank:&nbsp;@TVEyesModel.DMARank</span>
                                                                            }
                                                                        </td>
                                                                        <td align="right">
                                                                            &nbsp;
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                                            break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.MS:

                                                                            IQArchive_ArchiveMiscModel miscModel = item.MediaData as IQArchive_ArchiveMiscModel;

                                                                            Month = miscModel.CreateDT.ToString("MMM", System.Globalization.CultureInfo.InvariantCulture);
                                                                            Day = miscModel.CreateDT.Day.ToString();
                                                                            Time = miscModel.CreateDT.ToString("hh:mm tt");

                                                                            string catimg = string.Empty;
                                                                            switch (miscModel.FileType)
                                                                            {
                                                                                case IQMedia.Shared.Utility.CommonFunctions.IQUGCMediaTypes.Doc:
                                                                                    catimg = "word.png";
                                                                                    break;
                                                                                case IQMedia.Shared.Utility.CommonFunctions.IQUGCMediaTypes.Excel:
                                                                                    catimg = "excel.png";
                                                                                    break;
                                                                                case IQMedia.Shared.Utility.CommonFunctions.IQUGCMediaTypes.Pdf:
                                                                                    catimg = "pdf.png";
                                                                                    break;
                                                                                case IQMedia.Shared.Utility.CommonFunctions.IQUGCMediaTypes.Image:
                                                                                    catimg = "image.png";
                                                                                    break;
                                                                                default:
                                                                                    catimg = string.Empty;
                                                                                    break;
                                                                            }

                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    @Time @miscModel.TimeZone
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/" + catimg)" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.MS)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@miscModel.MediaUrl" target="_blank" style="color: #333333;">@Html.Raw(item.Title)</a>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                                                       break;

                                                            case IQMedia.Shared.Utility.CommonFunctions.CategoryType.PQ:

                                                                                       IQArchive_ArchivePQModel pqModel = item.MediaData as IQArchive_ArchivePQModel;
                                                                                       string authors = String.Empty;
                                                                                       if (pqModel.Authors != null && pqModel.Authors.Count > 0)
                                                                                       {
                                                                                           if (pqModel.Authors.Count > 2)
                                                                                           {
                                                                                               authors = "(" + String.Join(", ", pqModel.Authors.Take(2)) + ", ...) ";
                                                                                           }
                                                                                           else
                                                                                           {
                                                                                               authors = "(" + String.Join(", ", pqModel.Authors) + ") ";
                                                                                           }
                                                                                       }
                    
                                                    <table style="padding: 10px 0; width: 100%; background-color: #FFFFFF;">
                                                        <tr>
                                                            <td style="padding: 0;">
                                                                <table style="width: 100%;">
                                                                    <tr>
                                                                        <td valign="top" style="width: 75px;">
                                                                            <table style="margin-right: 10px; width: 75px;">
                                                                                <tr>
                                                                                    <td style="background-color: #EEEEEE; color: #fff; width: 75px; height: auto; text-align: center;
                                                                                        padding: 0px;">
                                                                                        <table style="width: 100%">
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; text-transform: uppercase; display: block;
                                                                                                    font-size: 13px; font-weight: bold; padding: 0px; background: #666666; color: #fff;
                                                                                                    text-align: center;">
                                                                                                    @Month
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; background-color: white; text-align: center;
                                                                                                    z-index: 10; padding-bottom: 1px; padding-top: 1px; font-size: 22px; display: block;
                                                                                                    color: #2B2B2B; text-align: center;">
                                                                                                    @Day
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td style="font-family: 'Microsoft Sans Serif'; font-size: 9px;
                                                                                                    color: #2B2B2B; display: block; text-align: center;">
                                                                                                    &nbsp;
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td align="center" style="margin: 10px 0 3px 0px;">
                                                                                        <img src="@(ImageBaseUrl + "MediaIcon/print-media_T.png")" alt="@IQMedia.Shared.Utility.CommonFunctions.GetEnumDescription(IQMedia.Shared.Utility.CommonFunctions.CategoryType.PQ)" />
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                        <td style="padding-right: 6px; font-size: 13px; font-family: 'Microsoft Sans Serif';
                                                                            vertical-align: top;">
                                                                            <table>
                                                                                <tr>
                                                                                    <td>
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; margin-right: 10px; font-size: 14px;">
                                                                                            <a href="@(BaseUrl + "/ProQuest/Index?source=library&id=" + item.ID)" target="_blank" style="color: #333333;">@Html.Raw(item.Title)</a>
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td style="margin-top: 5px; font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                        <span style="font-family: 'Microsoft Sans Serif'; font-size: 14px;">
                                                                                            <span style="color: #73797F;">@pqModel.Publication @authors</span>- @Html.Raw(item.DisplayText)
                                                                                        </span>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); background-color: #F4F4F4;">
                                                            <td style="padding: 0;">
                                                                <table width="100%" cellspacing="0" cellpadding="0" style="font-family: 'Microsoft Sans Serif'; line-height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); width: 100%;">
                                                                    <tr style="height: height: @(Model.ReportDetails.Settings.ShowSentiment ? "20px" : "2px"); background-color: #F4F4F4;">
                                                                        <td style="width: 80px;">
                                                                        </td>
                                                                        <td style="width: 160px;">
                                                                            @if (Model.ReportDetails.Settings.ShowSentiment)
                                                                            {
                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td style="margin-bottom: 4px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-up.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="margin-top: 3px">
                                                                                                <img src="@(ImageBaseUrl + "thumbs-down.png")" width="13" />
                                                                                            </td>
                                                                                            <td style="background-color: #DEDEDE; color: #FFFFFF; float: right; height: 15px;
                                                                                                margin-left: 3px; padding: 0 !important; text-align: center; width: 52px;">
                                                                                                <table cellspacing="0" cellpadding="0" style="height: 15px; text-align: center;">
                                                                                                    <tbody>
                                                                                                        <tr>
                                                                                                            <td align="right" style="width: 26px; padding: 0px !important; -moz-box-sizing: border-box;
                                                                                                                box-sizing: border-box; border-right: 1px solid #ffffff; background-color: #DEDEDE;
                                                                                                                color: White; overflow: hidden;">
                                                                                                                <span style="width:@((pqModel.NegativeSentiment * 6) > 25 ? 25 : (pqModel.NegativeSentiment * 6))px;background-color: #d8635d; color: #FFFFFF; float: right !important;line-height: 15px; overflow: hidden; padding: 0 !important;">
                                                                                                                    @(pqModel.NegativeSentiment > 0 ? pqModel.NegativeSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                            <td align="left" style="width: 25px;">
                                                                                                                <span style="width:@((pqModel.PositiveSentiment * 6) > 25 ? 25 : (pqModel.PositiveSentiment * 6))px;color: #FFFFFF; line-height: 15px; background-color: #c7d36a;overflow: hidden; padding: 0px ! important; float: left ! important;">
                                                                                                                    @(pqModel.PositiveSentiment > 0 ? pqModel.PositiveSentiment.ToString() : string.Empty)</span>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            }
                                                                        </td>
                                                                        <td style="width: 240px;">
                                                                        </td>
                                                                        <td align="right">
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>

                                                                            break;
                                                        }
                                                    }
                                                }
                                                }
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            }
                        }
                    </table>
                </td>
            </tr>
        </table>
    }
</body>
</html>
